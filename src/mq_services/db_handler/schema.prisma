datasource db {
    provider          = "postgresql"
    url               = env("DATABASE_URL")
    shadowDatabaseUrl = env("SHADOW_DATABASE_URL") // Only needed when using a cloud provider that doesn't support the creation of new databases, like Neon. Learn more: https://pris.ly/d/migrate-shadow
}

// User Schema

// Course Schema

model Course {
    id          Int          @id @default(autoincrement())
    tag         String       @unique
    name        String?
    assignments Assignment[]
}

model Assignment {
    id           Int          @id @default(autoincrement())
    name         String
    dueDate      DateTime?
    courseId     Int?
    Course       Course?      @relation(fields: [courseId], references: [id], onDelete: Cascade)
    repositories Repository[]
}

model Group {
    id             Int          @id @default(autoincrement())
    githubLink     String
    blackboardLink String?
    repositories   Repository[]
}

model Repository {
    id         Int    @id @default(autoincrement())
    githubLink String

    Group              Group?               @relation(fields: [groupId], references: [id])
    groupId            Int?
    Assignment         Assignment?          @relation(fields: [assignmentId], references: [id])
    assignmentId       Int?
    gitAnalysis        GitAnalysis[]
    lighthouseAnalysis LighthouseAnalysis[]
}

// Analyzer 1 Schema

model GitAnalysis {
    id             Int         @id @default(autoincrement())
    Repository     Repository? @relation(fields: [repositoryId], references: [id])
    repositoryId   Int?
    numberCommits  Int
    commitsPerUser Json
    commitsPerDay  Json
}

// Analyzer 2 Schema

model LighthouseAnalysis {
    id           Int         @id @default(autoincrement())
    fcp          String
    hasHttps     Boolean?
    hasViewport  Boolean
    Repository   Repository? @relation(fields: [repositoryId], references: [id])
    repositoryId Int?
}

model MetricsDescriptions {
    id          Int    @id @default(autoincrement())
    metric_name String
    description String
}
